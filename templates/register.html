{% extends "layout.html" %}

{% block title %}
    Register
{% endblock %}

{% block main %}
<main class="container p-5">
    <form id="register-form" action="/register" method="post">
        <div class="form-group">
            <input autofocus class="form-control" name="name" placeholder="Name" type="text" required>
        </div>
        <div class="form-group">
            <input autofocus class="form-control" name="email" placeholder="Email" type="email">
        </div>
        <div class="form-group">
            <input autocomplete="off" autofocus class="form-control" name="username" id="uname" placeholder="Username" type="text">
        </div>
        <div class="form-group">
            <input class="form-control" name="password" placeholder="Password" type="password">
        </div>
        <div class="form-group">
            <input class="form-control" name="confirmation" placeholder="Confirm password" type="password">
        </div>
        <div class="form-group">
            <h5><font color="white">Select club categories you're interested in</font></h5>
            <select class="custom-select form-control" name="preferences" multiple>
                <option value="Free Food">Free Food</option>
                <option value="Academic and Pre-Professional">Academic and Pre-Professional</option>
                <option value="College Life">College Life</option>
                <option value="Creative and Performing Arts">Creative and Performing Arts</option>
                <option value="Cultural and Racial Initiatives">Cultural and Racial Initiatives</option>
                <option value="Gender and Sexuality">Gender and Sexuality</option>
                <option value="Government and Politics">Government and Politics</option>
                <option value="Health and Wellness">Health and Wellness</option>
                <option value="Hobbies and Special Interests">Hobbies and Special Interests</option>
                <option value="Media and Publications">Media and Publications</option>
                <option value="PBHA">PBHA</option>
                <option value="Peer Counseling/Peer Education">Peer Counseling/Peer Education</option>
                <option value="Public Service">Public Service</option>
                <option value="Religious and Spiritual Life">Religious and Spiritual Life</option>
                <option value="SEAS">SEAS</option>
                <option value="Social Organization">Social Organization</option>
                <option value="Women's Initiatives">Women's Initiatives</option>
            </select>
        </div>
        <div>
            <h5><font color="white">
                Select the clubs that you are a member of:
            <br>
                (this will give you permission to post events for the club)
            </font></h5>
            <select multiple class="form-control" name="permissions" id="permissions">
                <option value="" selected disabled>Begin typing to filter...</option>
                {% for club in clubs %}
                    <option value="{{ club["name"] }}">{{ club["name"] }}</option>
                {% endfor %}
                <option value="None">None</option>
            </select>
        </div>
        <button class="btn btn-primary" type="submit">Register</button>
    </form>

    <script>
        document.querySelector("form").onsubmit = function(event) {
            event.preventDefault();
            let username = document.forms["register-form"]["username"].value;
            $.getJSON("/check?username=" + username, function(data) {
                if (data == false) {
                    alert("Username is already taken!");
                    return false;
                }
                else {
                    document.getElementById("register-form").submit();
                    return true;
                }
            });
        };
    </script>
</main>
{% endblock %}
